<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anonim Mesajlaşma</title>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" />
<style>
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Open Sans', sans-serif; }
html, body { width: 100%; height: 100%; overflow: hidden; }

body {
    background: linear-gradient(0deg, #000428, #004e92, #000428, #004e92);
    background-size: 400% 400%;
    animation: slowGradient 40s ease infinite;
    position: relative;
    color: white;
}

@keyframes slowGradient {
    0%{background-position:0% 0%}
    25%{background-position:100% 0%}
    50%{background-position:100% 100%}
    75%{background-position:0% 100%}
    100%{background-position:0% 0%}
}

.chat-container {
    position: absolute;
    top:0; left:0;
    width:100%;
    height:100%;
    display:flex;
    flex-direction:column;
    background-color: rgba(0,0,0,0.7);
    overflow:hidden;
}

.profile-panel {
    display:flex;
    align-items:center;
    padding:10px 20px;
    gap:10px;
    background-color: rgba(0,0,0,0.5);
}

.profile-panel input[type="text"] {
    padding:10px 15px;
    border-radius:25px;
    border:none;
    outline:none;
    font-size:14px;
    color:white;
    background-color: rgba(255,255,255,0.2);
}

.profile-panel img, .profile-panel i {
    width:50px;
    height:50px;
    border-radius:50%;
    object-fit:cover;
    cursor:pointer;
    font-size:30px;
    display:flex;
    justify-content:center;
    align-items:center;
    background:none;
}

.messages {
    flex:1;
    padding:20px;
    overflow-y:auto;
    display:flex;
    flex-direction:column;
    gap:10px;
}

.message {
    max-width:70%;
    padding:10px 15px;
    border-radius:15px;
    animation: fadeIn 0.5s ease;
    word-wrap: break-word;
    display:flex;
    align-items:center;
    gap:10px;
    position: relative;
}

.message.user { align-self:flex-end; background-color:#0084ff; color:white;}
.message.bot { align-self:flex-start; background-color:#e5e5ea; color:black; }

.message .name { font-weight:bold; }

@keyframes fadeIn { from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

.input-container {
    display:flex;
    padding:10px;
    background-color: rgba(255,255,255,0.1);
    align-items:center;
    gap:5px;
}

.input-container input {
    flex:1;
    padding:10px 15px;
    border-radius:25px;
    border:none;
    outline:none;
    font-size:14px;
    color:white;
    background-color: rgba(255,255,255,0.2);
}

.input-container button {
    background-color: rgba(255,255,255,0.2);
    border:none;
    border-radius:50%;
    width:45px;
    height:45px;
    cursor:pointer;
    display:flex;
    justify-content:center;
    align-items:center;
    transition: all 0.3s ease;
    color:white;
    font-size:18px;
}

.input-container button:hover { background-color: rgba(255,255,255,0.4); transform:scale(1.1); }

</style>
</head>
<body>

<div class="chat-container">
    <div class="profile-panel">
        <img id="avatarPreview" src="" alt="" style="display:none;">
        <i id="userIcon" class="fas fa-user"></i>
        <input type="text" id="usernameInput" placeholder="Kullanıcı adı" value="Anonim">
      
        <input type="file" id="avatarInput" accept="image/*" style="display:none;">
    </div>
    <div class="messages" id="messages"></div>
    <div class="input-container">
        <button class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        <input type="text" id="messageInput" placeholder="Mesaj yaz...">
        <button class="photo-btn" onclick="addImage()"><i class="fas fa-image"></i></button>
        <button class="audio-btn" onclick="toggleRecording()"><i class="fas fa-microphone"></i></button>
        <input type="file" id="imageInput" accept="image/*" style="display:none;">
    </div>
</div>

<script>
const messagesContainer = document.getElementById('messages');
const messageInput = document.getElementById('messageInput');
const imageInput = document.getElementById('imageInput');
const avatarInput = document.getElementById('avatarInput');
const avatarPreview = document.getElementById('avatarPreview');
const usernameInput = document.getElementById('usernameInput');
const userIcon = document.getElementById('userIcon');

let userProfile = { name: usernameInput.value, avatar: '' };

// Avatar seçimi
function selectAvatar() { avatarInput.click(); }
avatarPreview.addEventListener('click', selectAvatar);
userIcon.addEventListener('click', selectAvatar);

avatarInput.addEventListener('change', function(){
    const file = this.files[0];
    if(file){
        const reader = new FileReader();
        reader.onload = function(e){
            userProfile.avatar = e.target.result;
            avatarPreview.src = e.target.result;
            userIcon.style.display = 'none';
            avatarPreview.style.display = 'flex';
        }
        reader.readAsDataURL(file);
    }
});

// Mesaj gönderme
function sendMessage() {
    const text = messageInput.value.trim();
    if(!text) return;
    userProfile.name = usernameInput.value || 'Anonim';
    addMessage({text:text, profile:userProfile}, 'user');
    messageInput.value = '';
}

// Enter ile gönderme
messageInput.addEventListener('keypress', function(e){
    if(e.key === 'Enter') sendMessage();
});

// Mesaj ekleme
function addMessage(content, sender){
    const msg = document.createElement('div');
    msg.classList.add('message', sender);
    if(sender==='user') msg.style.backgroundColor='#0084ff';
    else msg.style.backgroundColor='#e5e5ea', msg.style.color='black';

    const nameEl = document.createElement('span');
    nameEl.className='name';
    nameEl.textContent = sender==='user' ? content.profile.name : 'Bot';
    msg.appendChild(nameEl);

    const textEl = document.createElement('span');
    textEl.textContent = content.text;
    msg.appendChild(textEl);

    if(content.img) msg.appendChild(content.img);

    // Sağ tık menüsü
    msg.addEventListener('contextmenu', function(e){
        e.preventDefault();
        const action = prompt("İşlem: sil veya yanıtla", "sil/yanıtla");
        if(action==='sil') msg.remove();
        else if(action==='yanıtla') messageInput.value = "@"+content.profile.name+": ";
    });

    messagesContainer.appendChild(msg);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Resim ekleme
function addImage(){ imageInput.click(); }
imageInput.addEventListener('change', function(){
    const file = this.files[0];
    if(file){
        const reader = new FileReader();
        reader.onload = function(e){
            const img = document.createElement('img');
            img.src = e.target.result;
            img.style.maxWidth='100%';
            img.style.borderRadius='10px';
            addMessage({text:'', profile:userProfile, img:img}, 'user');
        }
        reader.readAsDataURL(file);
    }
});

// Ses kaydı
let mediaRecorder;
let audioChunks = [];
let recording = false;
async function toggleRecording(){
    if(recording){
        mediaRecorder.stop();
        recording=false;
    } else {
        const stream = await navigator.mediaDevices.getUserMedia({audio:true});
        mediaRecorder = new MediaRecorder(stream);
        mediaRecorder.start();
        recording=true;
        audioChunks=[];
        mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
        mediaRecorder.onstop = () => {
            const blob = new Blob(audioChunks,{type:'audio/webm'});
            const audioURL = URL.createObjectURL(blob);
            const audio = document.createElement('audio');
            audio.controls=true;
            audio.src=audioURL;
            addMessage({text:'', profile:userProfile, img:audio}, 'user');
        }
    }
}

// Profil ve mesajları sıfırlama
function resetProfile(){
    messagesContainer.innerHTML='';
    userProfile = {name:'Anonim', avatar:''};
    usernameInput.value='Anonim';
    avatarPreview.src='';
    avatarPreview.style.display='none';
    userIcon.style.display='flex';
}
</script>
</body>
</html>
